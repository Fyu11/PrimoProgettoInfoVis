<!DOCTYPE html>
<html>
<head>
    <title>Quadrifogli</title>
	<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
	<meta content="utf-8" http-equiv="encoding">
    <script  type="text/javascript" src="lib/d3.v6.min.js"></script>
    <script src="http://d3js.org/d3.v5.min.js"></script>
    <script src="https://d3js.org/d3-array.v2.min.js"></script>
</head>
<body>
  <svg width="100%" height="400"></svg>
  <script>

    var NUM_CLOVERS = 10;
    var ANGLES = [0, 90, 180, 270];
    var casei = [];

    async function extractData(i){
      return await d3.json("file.json")
                     .then(async function extract(data){
                              return data[i];
                           });
    }

    function drawleaf(degree, x, y, val_scale){

      console.log(val_scale)
      //bisogna utilizzare questo valore per disegnare le foglie in modo proporzionale allo stesso

      var svg = d3.select("svg");
      var startx = 266;
      var starty = 221;

      svg.append("path")
      .attr('d', 'M266,221c-10.49,-20.79,-56.08,-73.11,-50.09,-32.06c1.98,9.99,-17.83,1.25,-14.03,16.03c0.8,20.79,51.57,16.78,64.12,16.03Z')
      .attr('stroke', 'green')
      .attr('fill', 'green')
      .attr("transform", "translate("+x+","+y+"), rotate("+degree+" "+startx+" "+starty+")");
    }

    function drawclover(x,y,obj){

      var temp = d3.values(obj)
      var array = d3.values(temp[0])
      var j=0;

      for (let i in ANGLES){
        drawleaf(ANGLES[i],x,y,array[j]);
        j++;
      }
    }

    async function drawclovers(){

      width=-200
      for (i=0; i<NUM_CLOVERS; i++){
        let casei = await extractData(i);
        drawclover(width,-100,casei)
        width+=190
      }
    }

    drawclovers();

  </script>

</body>
</html>
